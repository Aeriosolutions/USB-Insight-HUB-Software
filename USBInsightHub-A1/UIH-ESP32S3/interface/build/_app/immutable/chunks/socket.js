import{w as Ge}from"./singletons.js";import{c as Mr}from"./_commonjsHelpers.js";var J={},gr={},kr={},Fr={},vr={},mr={},Je=Rr(typeof Buffer<"u"&&Buffer)||Rr(Mr.Buffer)||Rr(typeof window<"u"&&window.Buffer)||Mr.Buffer;function Rr(r){return r&&r.isBuffer&&r}var Ze={}.toString,qr=Array.isArray||function(r){return Ze.call(r)=="[object Array]"},Ir={exports:{}},Hr;function Xe(){if(Hr)return Ir.exports;Hr=1;var r=j(),e=Ir.exports=t(0);e.alloc=t,e.concat=r.concat,e.from=n;function t(i){return new Array(i)}function n(i){if(!r.isBuffer(i)&&r.isView(i))i=r.Uint8Array.from(i);else if(r.isArrayBuffer(i))i=new Uint8Array(i);else{if(typeof i=="string")return r.from.call(e,i);if(typeof i=="number")throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(i)}return Ir.exports}var Pr={exports:{}},Gr;function Ke(){if(Gr)return Pr.exports;Gr=1;var r=j(),e=r.global,t=Pr.exports=r.hasBuffer?n(0):[];t.alloc=r.hasBuffer&&e.alloc||n,t.concat=r.concat,t.from=i;function n(f){return new e(f)}function i(f){if(!r.isBuffer(f)&&r.isView(f))f=r.Uint8Array.from(f);else if(r.isArrayBuffer(f))f=new Uint8Array(f);else{if(typeof f=="string")return r.from.call(t,f);if(typeof f=="number")throw new TypeError('"value" argument must not be a number')}return e.from&&e.from.length!==1?e.from(f):new e(f)}return Pr.exports}var _r={exports:{}},Jr;function Qe(){if(Jr)return _r.exports;Jr=1;var r=j(),e=_r.exports=r.hasArrayBuffer?t(0):[];e.alloc=t,e.concat=r.concat,e.from=n;function t(i){return new Uint8Array(i)}function n(i){if(r.isView(i)){var f=i.byteOffset,o=i.byteLength;i=i.buffer,i.byteLength!==o&&(i.slice?i=i.slice(f,f+o):(i=new Uint8Array(i),i.byteLength!==o&&(i=Array.prototype.slice.call(i,f,f+o))))}else{if(typeof i=="string")return r.from.call(e,i);if(typeof i=="number")throw new TypeError('"value" argument must not be a number')}return new Uint8Array(i)}return _r.exports}var tr={},lr={};lr.copy=tt;lr.toString=et;lr.write=rt;function rt(r,e){for(var t=this,n=e||(e|=0),i=r.length,f=0,o=0;o<i;)f=r.charCodeAt(o++),f<128?t[n++]=f:f<2048?(t[n++]=192|f>>>6,t[n++]=128|f&63):f<55296||f>57343?(t[n++]=224|f>>>12,t[n++]=128|f>>>6&63,t[n++]=128|f&63):(f=(f-55296<<10|r.charCodeAt(o++)-56320)+65536,t[n++]=240|f>>>18,t[n++]=128|f>>>12&63,t[n++]=128|f>>>6&63,t[n++]=128|f&63);return n-e}function et(r,e,t){var n=this,i=e|0;t||(t=n.length);for(var f="",o=0;i<t;){if(o=n[i++],o<128){f+=String.fromCharCode(o);continue}(o&224)===192?o=(o&31)<<6|n[i++]&63:(o&240)===224?o=(o&15)<<12|(n[i++]&63)<<6|n[i++]&63:(o&248)===240&&(o=(o&7)<<18|(n[i++]&63)<<12|(n[i++]&63)<<6|n[i++]&63),o>=65536?(o-=65536,f+=String.fromCharCode((o>>>10)+55296,(o&1023)+56320)):f+=String.fromCharCode(o)}return f}function tt(r,e,t,n){var i;t||(t=0),!n&&n!==0&&(n=this.length),e||(e=0);var f=n-t;if(r===this&&t<e&&e<n)for(i=f-1;i>=0;i--)r[i+e]=this[i+t];else for(i=0;i<f;i++)r[i+e]=this[i+t];return f}var Zr;function Or(){if(Zr)return tr;Zr=1;var r=lr;tr.copy=f,tr.slice=o,tr.toString=E,tr.write=d("write");var e=j(),t=e.global,n=e.hasBuffer&&"TYPED_ARRAY_SUPPORT"in t,i=n&&!t.TYPED_ARRAY_SUPPORT;function f(x,a,s,h){var v=e.isBuffer(this),y=e.isBuffer(x);if(v&&y)return this.copy(x,a,s,h);if(!i&&!v&&!y&&e.isView(this)&&e.isView(x)){var _=s||h!=null?o.call(this,s,h):this;return x.set(_,a),_.length}else return r.copy.call(this,x,a,s,h)}function o(x,a){var s=this.slice||!i&&this.subarray;if(s)return s.call(this,x,a);var h=e.alloc.call(this,a-x);return f.call(this,h,0,x,a),h}function E(x,a,s){var h=!n&&e.isBuffer(this)?this.toString:r.toString;return h.apply(this,arguments)}function d(x){return a;function a(){var s=this[x]||r[x];return s.apply(this,arguments)}}return tr}var Xr;function j(){return Xr||(Xr=1,function(r){var e=r.global=Je,t=r.hasBuffer=e&&!!e.isBuffer,n=r.hasArrayBuffer=typeof ArrayBuffer<"u",i=r.isArray=qr;r.isArrayBuffer=n?_:F;var f=r.isBuffer=t?e.isBuffer:F,o=r.isView=n?ArrayBuffer.isView||$("ArrayBuffer","buffer"):F;r.alloc=h,r.concat=v,r.from=s;var E=r.Array=Xe(),d=r.Buffer=Ke(),x=r.Uint8Array=Qe(),a=r.prototype=Or();function s(g){return typeof g=="string"?B.call(this,g):k(this).from(g)}function h(g){return k(this).alloc(g)}function v(g,D){D||(D=0,Array.prototype.forEach.call(g,w));var N=this!==r&&this||g[0],b=h.call(N,D),l=0;return Array.prototype.forEach.call(g,u),b;function w(c){D+=c.length}function u(c){l+=a.copy.call(c,b,l)}}var y=$("ArrayBuffer");function _(g){return g instanceof ArrayBuffer||y(g)}function B(g){var D=g.length*3,N=h.call(this,D),b=a.write.call(N,g);return D!==b&&(N=a.slice.call(N,0,b)),N}function k(g){return f(g)?d:o(g)?x:i(g)?E:t?d:n?x:E}function F(){return!1}function $(g,D){return g="[object "+g+"]",function(N){return N!=null&&{}.toString.call(D?N[D]:N)===g}}}(mr)),mr}vr.ExtBuffer=$r;var nt=j();function $r(r,e){if(!(this instanceof $r))return new $r(r,e);this.buffer=nt.from(r),this.type=e}var Sr={},Kr;function it(){if(Kr)return Sr;Kr=1,Sr.setExtPackers=f;var r=j(),e=r.global,t=r.Uint8Array.from,n,i={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function f(a){a.addExtPacker(14,Error,[x,o]),a.addExtPacker(1,EvalError,[x,o]),a.addExtPacker(2,RangeError,[x,o]),a.addExtPacker(3,ReferenceError,[x,o]),a.addExtPacker(4,SyntaxError,[x,o]),a.addExtPacker(5,TypeError,[x,o]),a.addExtPacker(6,URIError,[x,o]),a.addExtPacker(10,RegExp,[d,o]),a.addExtPacker(11,Boolean,[E,o]),a.addExtPacker(12,String,[E,o]),a.addExtPacker(13,Date,[Number,o]),a.addExtPacker(15,Number,[E,o]),typeof Uint8Array<"u"&&(a.addExtPacker(17,Int8Array,t),a.addExtPacker(18,Uint8Array,t),a.addExtPacker(19,Int16Array,t),a.addExtPacker(20,Uint16Array,t),a.addExtPacker(21,Int32Array,t),a.addExtPacker(22,Uint32Array,t),a.addExtPacker(23,Float32Array,t),typeof Float64Array<"u"&&a.addExtPacker(24,Float64Array,t),typeof Uint8ClampedArray<"u"&&a.addExtPacker(25,Uint8ClampedArray,t),a.addExtPacker(26,ArrayBuffer,t),a.addExtPacker(29,DataView,t)),r.hasBuffer&&a.addExtPacker(27,e,r.from)}function o(a){return n||(n=Fe().encode),n(a)}function E(a){return a.valueOf()}function d(a){a=RegExp.prototype.toString.call(a).split("/"),a.shift();var s=[a.pop()];return s.unshift(a.join("/")),s}function x(a){var s={};for(var h in i)s[h]=a[h];return s}return Sr}var ce={},yr={};(function(r){(function(e){var t="undefined",n=t!==typeof Buffer&&Buffer,i=t!==typeof Uint8Array&&Uint8Array,f=t!==typeof ArrayBuffer&&ArrayBuffer,o=[0,0,0,0,0,0,0,0],E=Array.isArray||N,d=4294967296,x=16777216,a;s("Uint64BE",!0,!0),s("Int64BE",!0,!1),s("Uint64LE",!1,!0),s("Int64LE",!1,!1);function s(b,l,w){var u=l?0:4,c=l?4:0,p=l?0:3,I=l?1:2,T=l?2:1,q=l?3:0,W=l?F:g,er=l?$:D,M=G.prototype,H="is"+b,cr="_"+H;return M.buffer=void 0,M.offset=0,M[cr]=!0,M.toNumber=Vr,M.toString=ze,M.toJSON=Vr,M.toArray=h,n&&(M.toBuffer=v),i&&(M.toArrayBuffer=y),G[H]=Ur,e[b]=G,G;function G(m,A,U,R){return this instanceof G?Le(this,m,A,U,R):new G(m,A,U,R)}function Ur(m){return!!(m&&m[cr])}function Le(m,A,U,R,C){if(i&&f&&(A instanceof f&&(A=new i(A)),R instanceof f&&(R=new i(R))),!A&&!U&&!R&&!a){m.buffer=k(o,0);return}if(!_(A,U)){var L=a||Array;C=U,R=A,U=0,A=new L(8)}m.buffer=A,m.offset=U|=0,t!==typeof R&&(typeof R=="string"?Ve(A,U,R,C||10):_(R,C)?B(A,U,R,C):typeof C=="number"?(xr(A,U+u,R),xr(A,U+c,C)):R>0?W(A,U,R):R<0?er(A,U,R):B(A,U,o,0))}function Ve(m,A,U,R){var C=0,L=U.length,V=0,Y=0;U[0]==="-"&&C++;for(var He=C;C<L;){var zr=parseInt(U[C++],R);if(!(zr>=0))break;Y=Y*R+zr,V=V*R+Math.floor(Y/d),Y%=d}He&&(V=~V,Y?Y=d-Y:V++),xr(m,A+u,V),xr(m,A+c,Y)}function Vr(){var m=this.buffer,A=this.offset,U=hr(m,A+u),R=hr(m,A+c);return w||(U|=0),U?U*d+R:R}function ze(m){var A=this.buffer,U=this.offset,R=hr(A,U+u),C=hr(A,U+c),L="",V=!w&&R&2147483648;for(V&&(R=~R,C=d-C),m=m||10;;){var Y=R%m*d+C;if(R=Math.floor(R/m),C=Math.floor(Y/m),L=(Y%m).toString(m)+L,!R&&!C)break}return V&&(L="-"+L),L}function xr(m,A,U){m[A+q]=U&255,U=U>>8,m[A+T]=U&255,U=U>>8,m[A+I]=U&255,U=U>>8,m[A+p]=U&255}function hr(m,A){return m[A+p]*x+(m[A+I]<<16)+(m[A+T]<<8)+m[A+q]}}function h(b){var l=this.buffer,w=this.offset;return a=null,b!==!1&&w===0&&l.length===8&&E(l)?l:k(l,w)}function v(b){var l=this.buffer,w=this.offset;if(a=n,b!==!1&&w===0&&l.length===8&&Buffer.isBuffer(l))return l;var u=new n(8);return B(u,0,l,w),u}function y(b){var l=this.buffer,w=this.offset,u=l.buffer;if(a=i,b!==!1&&w===0&&u instanceof f&&u.byteLength===8)return u;var c=new i(8);return B(c,0,l,w),c.buffer}function _(b,l){var w=b&&b.length;return l|=0,w&&l+8<=w&&typeof b[l]!="string"}function B(b,l,w,u){l|=0,u|=0;for(var c=0;c<8;c++)b[l++]=w[u++]&255}function k(b,l){return Array.prototype.slice.call(b,l,l+8)}function F(b,l,w){for(var u=l+8;u>l;)b[--u]=w&255,w/=256}function $(b,l,w){var u=l+8;for(w++;u>l;)b[--u]=-w&255^255,w/=256}function g(b,l,w){for(var u=l+8;l<u;)b[l++]=w&255,w/=256}function D(b,l,w){var u=l+8;for(w++;l<u;)b[l++]=-w&255^255,w/=256}function N(b){return!!b&&Object.prototype.toString.call(b)=="[object Array]"}})(typeof r.nodeName!="string"?r:Mr||{})})(yr);var xe={},Er={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Er.read=function(r,e,t,n,i){var f,o,E=i*8-n-1,d=(1<<E)-1,x=d>>1,a=-7,s=t?i-1:0,h=t?-1:1,v=r[e+s];for(s+=h,f=v&(1<<-a)-1,v>>=-a,a+=E;a>0;f=f*256+r[e+s],s+=h,a-=8);for(o=f&(1<<-a)-1,f>>=-a,a+=n;a>0;o=o*256+r[e+s],s+=h,a-=8);if(f===0)f=1-x;else{if(f===d)return o?NaN:(v?-1:1)*(1/0);o=o+Math.pow(2,n),f=f-x}return(v?-1:1)*o*Math.pow(2,f-n)};Er.write=function(r,e,t,n,i,f){var o,E,d,x=f*8-i-1,a=(1<<x)-1,s=a>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=n?0:f-1,y=n?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(E=isNaN(e)?1:0,o=a):(o=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-o))<1&&(o--,d*=2),o+s>=1?e+=h/d:e+=h*Math.pow(2,1-s),e*d>=2&&(o++,d/=2),o+s>=a?(E=0,o=a):o+s>=1?(E=(e*d-1)*Math.pow(2,i),o=o+s):(E=e*Math.pow(2,s-1)*Math.pow(2,i),o=0));i>=8;r[t+v]=E&255,v+=y,E/=256,i-=8);for(o=o<<i|E,x+=i;x>0;r[t+v]=o&255,v+=y,o/=256,x-=8);r[t+v-y]|=_*128};var jr={},ft=jr.uint8=new Array(256);for(var dr=0;dr<=255;dr++)ft[dr]=at(dr);function at(r){return function(e){var t=e.reserve(1);e.buffer[t]=r}}var he=Er,de=yr,ot=de.Uint64BE,ut=de.Int64BE,pe=jr.uint8,Br=j(),S=Br.global,st=Br.hasBuffer&&"TYPED_ARRAY_SUPPORT"in S,ct=st&&!S.TYPED_ARRAY_SUPPORT,Qr=Br.hasBuffer&&S.prototype||{};xe.getWriteToken=xt;function xt(r){return r&&r.uint8array?ht():ct||Br.hasBuffer&&r&&r.safe?dt():ve()}function ht(){var r=ve();return r[202]=P(202,4,Ee),r[203]=P(203,8,Be),r}function ve(){var r=pe.slice();return r[196]=or(196),r[197]=K(197),r[198]=Q(198),r[199]=or(199),r[200]=K(200),r[201]=Q(201),r[202]=P(202,4,Qr.writeFloatBE||Ee,!0),r[203]=P(203,8,Qr.writeDoubleBE||Be,!0),r[204]=or(204),r[205]=K(205),r[206]=Q(206),r[207]=P(207,8,le),r[208]=or(208),r[209]=K(209),r[210]=Q(210),r[211]=P(211,8,ye),r[217]=or(217),r[218]=K(218),r[219]=Q(219),r[220]=K(220),r[221]=Q(221),r[222]=K(222),r[223]=Q(223),r}function dt(){var r=pe.slice();return r[196]=P(196,1,S.prototype.writeUInt8),r[197]=P(197,2,S.prototype.writeUInt16BE),r[198]=P(198,4,S.prototype.writeUInt32BE),r[199]=P(199,1,S.prototype.writeUInt8),r[200]=P(200,2,S.prototype.writeUInt16BE),r[201]=P(201,4,S.prototype.writeUInt32BE),r[202]=P(202,4,S.prototype.writeFloatBE),r[203]=P(203,8,S.prototype.writeDoubleBE),r[204]=P(204,1,S.prototype.writeUInt8),r[205]=P(205,2,S.prototype.writeUInt16BE),r[206]=P(206,4,S.prototype.writeUInt32BE),r[207]=P(207,8,le),r[208]=P(208,1,S.prototype.writeInt8),r[209]=P(209,2,S.prototype.writeInt16BE),r[210]=P(210,4,S.prototype.writeInt32BE),r[211]=P(211,8,ye),r[217]=P(217,1,S.prototype.writeUInt8),r[218]=P(218,2,S.prototype.writeUInt16BE),r[219]=P(219,4,S.prototype.writeUInt32BE),r[220]=P(220,2,S.prototype.writeUInt16BE),r[221]=P(221,4,S.prototype.writeUInt32BE),r[222]=P(222,2,S.prototype.writeUInt16BE),r[223]=P(223,4,S.prototype.writeUInt32BE),r}function or(r){return function(e,t){var n=e.reserve(2),i=e.buffer;i[n++]=r,i[n]=t}}function K(r){return function(e,t){var n=e.reserve(3),i=e.buffer;i[n++]=r,i[n++]=t>>>8,i[n]=t}}function Q(r){return function(e,t){var n=e.reserve(5),i=e.buffer;i[n++]=r,i[n++]=t>>>24,i[n++]=t>>>16,i[n++]=t>>>8,i[n]=t}}function P(r,e,t,n){return function(i,f){var o=i.reserve(e+1);i.buffer[o++]=r,t.call(i.buffer,f,o,n)}}function le(r,e){new ot(this,e,r)}function ye(r,e){new ut(this,e,r)}function Ee(r,e){he.write(this,r,e,!1,23,4)}function Be(r,e){he.write(this,r,e,!1,52,8)}var pt=qr,we=yr,vt=we.Uint64BE,lt=we.Int64BE,re=j(),ee=Or(),yt=xe,Et=jr.uint8,Bt=vr.ExtBuffer,wt=typeof Uint8Array<"u",bt=typeof Map<"u",ar=[];ar[1]=212;ar[2]=213;ar[4]=214;ar[8]=215;ar[16]=216;ce.getWriteType=At;function At(r){var e=yt.getWriteToken(r),t=r&&r.useraw,n=wt&&r&&r.binarraybuffer,i=n?re.isArrayBuffer:re.isBuffer,f=n?D:g,o=bt&&r&&r.usemap,E=o?l:b,d={boolean:x,function:F,number:a,object:t?k:B,string:_(t?y:v),symbol:F,undefined:F};return d;function x(u,c){var p=c?195:194;e[p](u,c)}function a(u,c){var p=c|0,I;if(c!==p){I=203,e[I](u,c);return}else-32<=p&&p<=127?I=p&255:0<=p?I=p<=255?204:p<=65535?205:206:I=-128<=p?208:-32768<=p?209:210;e[I](u,p)}function s(u,c){var p=207;e[p](u,c.toArray())}function h(u,c){var p=211;e[p](u,c.toArray())}function v(u){return u<32?1:u<=255?2:u<=65535?3:5}function y(u){return u<32?1:u<=65535?3:5}function _(u){return c;function c(p,I){var T=I.length,q=5+T*3;p.offset=p.reserve(q);var W=p.buffer,er=u(T),M=p.offset+er;T=ee.write.call(W,I,M);var H=u(T);if(er!==H){var cr=M+H-er,G=M+T;ee.copy.call(W,W,cr,M,G)}var Ur=H===1?160+T:H<=3?215+H:219;e[Ur](p,T),p.offset+=T}}function B(u,c){if(c===null)return F(u,c);if(i(c))return f(u,c);if(pt(c))return $(u,c);if(vt.isUint64BE(c))return s(u,c);if(lt.isInt64BE(c))return h(u,c);var p=u.codec.getExtPacker(c);if(p&&(c=p(c)),c instanceof Bt)return N(u,c);E(u,c)}function k(u,c){if(i(c))return w(u,c);B(u,c)}function F(u,c){var p=192;e[p](u,c)}function $(u,c){var p=c.length,I=p<16?144+p:p<=65535?220:221;e[I](u,p);for(var T=u.codec.encode,q=0;q<p;q++)T(u,c[q])}function g(u,c){var p=c.length,I=p<255?196:p<=65535?197:198;e[I](u,p),u.send(c)}function D(u,c){g(u,new Uint8Array(c))}function N(u,c){var p=c.buffer,I=p.length,T=ar[I]||(I<255?199:I<=65535?200:201);e[T](u,I),Et[c.type](u),u.send(p)}function b(u,c){var p=Object.keys(c),I=p.length,T=I<16?128+I:I<=65535?222:223;e[T](u,I);var q=u.codec.encode;p.forEach(function(W){q(u,W),q(u,c[W])})}function l(u,c){if(!(c instanceof Map))return b(u,c);var p=c.size,I=p<16?128+p:p<=65535?222:223;e[I](u,p);var T=u.codec.encode;c.forEach(function(q,W,er){T(u,W),T(u,q)})}function w(u,c){var p=c.length,I=p<32?160+p:p<=65535?218:219;e[I](u,p),u.send(c)}}var X={},Ut=qr;X.createCodec=be;X.install=kt;X.filter=Rt;var gt=j();function nr(r){if(!(this instanceof nr))return new nr(r);this.options=r,this.init()}nr.prototype.init=function(){var r=this.options;return r&&r.uint8array&&(this.bufferish=gt.Uint8Array),this};function kt(r){for(var e in r)nr.prototype[e]=Ft(nr.prototype[e],r[e])}function Ft(r,e){return r&&e?t:r||e;function t(){return r.apply(this,arguments),e.apply(this,arguments)}}function mt(r){return r=r.slice(),function(t){return r.reduce(e,t)};function e(t,n){return n(t)}}function Rt(r){return Ut(r)?mt(r):r}function be(r){return new nr(r)}X.preset=be({preset:!0});var te;function Yr(){if(te)return Fr;te=1;var r=vr.ExtBuffer,e=it(),t=ce,n=X;n.install({addExtPacker:o,getExtPacker:E,init:f}),Fr.preset=f.call(n.preset);function i(d){var x=t.getWriteType(d);return a;function a(s,h){var v=x[typeof h];if(!v)throw new Error('Unsupported type "'+typeof h+'": '+h);v(s,h)}}function f(){var d=this.options;return this.encode=i(d),d&&d.preset&&e.setExtPackers(this),this}function o(d,x,a){a=n.filter(a);var s=x.name;if(s&&s!=="Object"){var h=this.extPackers||(this.extPackers={});h[s]=y}else{var v=this.extEncoderList||(this.extEncoderList=[]);v.unshift([x,y])}function y(_){return a&&(_=a(_)),new r(_,d)}}function E(d){var x=this.extPackers||(this.extPackers={}),a=d.constructor,s=a&&a.name&&x[a.name];if(s)return s;for(var h=this.extEncoderList||(this.extEncoderList=[]),v=h.length,y=0;y<v;y++){var _=h[y];if(a===_[0])return _[1]}}return Fr}var wr={};wr.FlexDecoder=ir;wr.FlexEncoder=fr;var sr=j(),It=2048,Pt=65536,ne="BUFFER_SHORTAGE";function ir(){if(!(this instanceof ir))return new ir}function fr(){if(!(this instanceof fr))return new fr}ir.mixin=ge(_t());ir.mixin(ir.prototype);fr.mixin=ge(St());fr.mixin(fr.prototype);function _t(){return{bufferish:sr,write:r,fetch:Dt,flush:e,push:Ue,pull:Nt,read:Ae,reserve:t,offset:0};function r(n){var i=this.offset?sr.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=i?n?this.bufferish.concat([i,n]):i:n,this.offset=0}function e(){for(;this.offset<this.buffer.length;){var n=this.offset,i;try{i=this.fetch()}catch(f){if(f&&f.message!=ne)throw f;this.offset=n;break}this.push(i)}}function t(n){var i=this.offset,f=i+n;if(f>this.buffer.length)throw new Error(ne);return this.offset=f,i}}function St(){return{bufferish:sr,write:Tt,fetch:r,flush:e,push:Ue,pull:t,read:Ae,reserve:n,send:i,maxBufferSize:Pt,minBufferSize:It,offset:0,start:0};function r(){var f=this.start;if(f<this.offset){var o=this.start=this.offset;return sr.prototype.slice.call(this.buffer,f,o)}}function e(){for(;this.start<this.offset;){var f=this.fetch();f&&this.push(f)}}function t(){var f=this.buffers||(this.buffers=[]),o=f.length>1?this.bufferish.concat(f):f[0];return f.length=0,o}function n(f){var o=f|0;if(this.buffer){var E=this.buffer.length,d=this.offset|0,x=d+o;if(x<E)return this.offset=x,d;this.flush(),f=Math.max(f,Math.min(E*2,this.maxBufferSize))}return f=Math.max(f,this.minBufferSize),this.buffer=this.bufferish.alloc(f),this.start=0,this.offset=o,0}function i(f){var o=f.length;if(o>this.minBufferSize)this.flush(),this.push(f);else{var E=this.reserve(o);sr.prototype.copy.call(f,this.buffer,E)}}}function Tt(){throw new Error("method not implemented: write()")}function Dt(){throw new Error("method not implemented: fetch()")}function Ae(){var r=this.buffers&&this.buffers.length;return r?(this.flush(),this.pull()):this.fetch()}function Ue(r){var e=this.buffers||(this.buffers=[]);e.push(r)}function Nt(){var r=this.buffers||(this.buffers=[]);return r.shift()}function ge(r){return e;function e(t){for(var n in r)t[n]=r[n];return t}}var ie;function ke(){if(ie)return kr;ie=1,kr.EncodeBuffer=t;var r=Yr().preset,e=wr.FlexEncoder;e.mixin(t.prototype);function t(n){if(!(this instanceof t))return new t(n);if(n&&(this.options=n,n.codec)){var i=this.codec=n.codec;i.bufferish&&(this.bufferish=i.bufferish)}}return t.prototype.codec=r,t.prototype.write=function(n){this.codec.encode(this,n)},kr}var fe;function Fe(){if(fe)return gr;fe=1,gr.encode=e;var r=ke().EncodeBuffer;function e(t,n){var i=new r(n);return i.write(t),i.read()}return gr}var Tr={},Dr={},Nr={},Cr={},ae;function Ct(){if(ae)return Cr;ae=1,Cr.setExtUnpackers=i;var r=j(),e=r.global,t,n={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function i(a){a.addExtUnpacker(14,[f,E(Error)]),a.addExtUnpacker(1,[f,E(EvalError)]),a.addExtUnpacker(2,[f,E(RangeError)]),a.addExtUnpacker(3,[f,E(ReferenceError)]),a.addExtUnpacker(4,[f,E(SyntaxError)]),a.addExtUnpacker(5,[f,E(TypeError)]),a.addExtUnpacker(6,[f,E(URIError)]),a.addExtUnpacker(10,[f,o]),a.addExtUnpacker(11,[f,d(Boolean)]),a.addExtUnpacker(12,[f,d(String)]),a.addExtUnpacker(13,[f,d(Date)]),a.addExtUnpacker(15,[f,d(Number)]),typeof Uint8Array<"u"&&(a.addExtUnpacker(17,d(Int8Array)),a.addExtUnpacker(18,d(Uint8Array)),a.addExtUnpacker(19,[x,d(Int16Array)]),a.addExtUnpacker(20,[x,d(Uint16Array)]),a.addExtUnpacker(21,[x,d(Int32Array)]),a.addExtUnpacker(22,[x,d(Uint32Array)]),a.addExtUnpacker(23,[x,d(Float32Array)]),typeof Float64Array<"u"&&a.addExtUnpacker(24,[x,d(Float64Array)]),typeof Uint8ClampedArray<"u"&&a.addExtUnpacker(25,d(Uint8ClampedArray)),a.addExtUnpacker(26,x),a.addExtUnpacker(29,[x,d(DataView)])),r.hasBuffer&&a.addExtUnpacker(27,d(e))}function f(a){return t||(t=Ne().decode),t(a)}function o(a){return RegExp.apply(null,a)}function E(a){return function(s){var h=new a;for(var v in n)h[v]=s[v];return h}}function d(a){return function(s){return new a(s)}}function x(a){return new Uint8Array(a).buffer}return Cr}var br={},me=Er,Re=yr,Ie=Re.Uint64BE,Pe=Re.Int64BE;br.getReadFormat=qt;br.readUint8=_e;var Wr=j(),Ar=Or(),Mt=typeof Map<"u",$t=!0;function qt(r){var e=Wr.hasArrayBuffer&&r&&r.binarraybuffer,t=r&&r.int64,n=Mt&&r&&r.usemap,i={map:n?jt:Ot,array:Yt,str:Wt,bin:e?Vt:Lt,ext:zt,uint8:_e,uint16:Gt,uint32:Zt,uint64:pr(8,t?rn:Kt),int8:Ht,int16:Jt,int32:Xt,int64:pr(8,t?en:Qt),float32:pr(4,tn),float64:pr(8,nn)};return i}function Ot(r,e){var t={},n,i=new Array(e),f=new Array(e),o=r.codec.decode;for(n=0;n<e;n++)i[n]=o(r),f[n]=o(r);for(n=0;n<e;n++)t[i[n]]=f[n];return t}function jt(r,e){var t=new Map,n,i=new Array(e),f=new Array(e),o=r.codec.decode;for(n=0;n<e;n++)i[n]=o(r),f[n]=o(r);for(n=0;n<e;n++)t.set(i[n],f[n]);return t}function Yt(r,e){for(var t=new Array(e),n=r.codec.decode,i=0;i<e;i++)t[i]=n(r);return t}function Wt(r,e){var t=r.reserve(e),n=t+e;return Ar.toString.call(r.buffer,"utf-8",t,n)}function Lt(r,e){var t=r.reserve(e),n=t+e,i=Ar.slice.call(r.buffer,t,n);return Wr.from(i)}function Vt(r,e){var t=r.reserve(e),n=t+e,i=Ar.slice.call(r.buffer,t,n);return Wr.Uint8Array.from(i).buffer}function zt(r,e){var t=r.reserve(e+1),n=r.buffer[t++],i=t+e,f=r.codec.getExtUnpacker(n);if(!f)throw new Error("Invalid ext type: "+(n&&"0x"+n.toString(16)));var o=Ar.slice.call(r.buffer,t,i);return f(o)}function _e(r){var e=r.reserve(1);return r.buffer[e]}function Ht(r){var e=r.reserve(1),t=r.buffer[e];return t&128?t-256:t}function Gt(r){var e=r.reserve(2),t=r.buffer;return t[e++]<<8|t[e]}function Jt(r){var e=r.reserve(2),t=r.buffer,n=t[e++]<<8|t[e];return n&32768?n-65536:n}function Zt(r){var e=r.reserve(4),t=r.buffer;return t[e++]*16777216+(t[e++]<<16)+(t[e++]<<8)+t[e]}function Xt(r){var e=r.reserve(4),t=r.buffer;return t[e++]<<24|t[e++]<<16|t[e++]<<8|t[e]}function pr(r,e){return function(t){var n=t.reserve(r);return e.call(t.buffer,n,$t)}}function Kt(r){return new Ie(this,r).toNumber()}function Qt(r){return new Pe(this,r).toNumber()}function rn(r){return new Ie(this,r)}function en(r){return new Pe(this,r)}function tn(r){return me.read(this,r,!1,23,4)}function nn(r){return me.read(this,r,!1,52,8)}var Se={},fn=br;Se.getReadToken=an;function an(r){var e=fn.getReadFormat(r);return r&&r.useraw?on(e):Te(e)}function Te(r){var e,t=new Array(256);for(e=0;e<=127;e++)t[e]=ur(e);for(e=128;e<=143;e++)t[e]=z(e-128,r.map);for(e=144;e<=159;e++)t[e]=z(e-144,r.array);for(e=160;e<=191;e++)t[e]=z(e-160,r.str);for(t[192]=ur(null),t[193]=null,t[194]=ur(!1),t[195]=ur(!0),t[196]=O(r.uint8,r.bin),t[197]=O(r.uint16,r.bin),t[198]=O(r.uint32,r.bin),t[199]=O(r.uint8,r.ext),t[200]=O(r.uint16,r.ext),t[201]=O(r.uint32,r.ext),t[202]=r.float32,t[203]=r.float64,t[204]=r.uint8,t[205]=r.uint16,t[206]=r.uint32,t[207]=r.uint64,t[208]=r.int8,t[209]=r.int16,t[210]=r.int32,t[211]=r.int64,t[212]=z(1,r.ext),t[213]=z(2,r.ext),t[214]=z(4,r.ext),t[215]=z(8,r.ext),t[216]=z(16,r.ext),t[217]=O(r.uint8,r.str),t[218]=O(r.uint16,r.str),t[219]=O(r.uint32,r.str),t[220]=O(r.uint16,r.array),t[221]=O(r.uint32,r.array),t[222]=O(r.uint16,r.map),t[223]=O(r.uint32,r.map),e=224;e<=255;e++)t[e]=ur(e-256);return t}function on(r){var e,t=Te(r).slice();for(t[217]=t[196],t[218]=t[197],t[219]=t[198],e=160;e<=191;e++)t[e]=z(e-160,r.bin);return t}function ur(r){return function(){return r}}function O(r,e){return function(t){var n=r(t);return e(t,n)}}function z(r,e){return function(t){return e(t,r)}}var oe;function Lr(){if(oe)return Nr;oe=1;var r=vr.ExtBuffer,e=Ct(),t=br.readUint8,n=Se,i=X;i.install({addExtUnpacker:E,getExtUnpacker:d,init:o}),Nr.preset=o.call(i.preset);function f(x){var a=n.getReadToken(x);return s;function s(h){var v=t(h),y=a[v];if(!y)throw new Error("Invalid type: "+(v&&"0x"+v.toString(16)));return y(h)}}function o(){var x=this.options;return this.decode=f(x),x&&x.preset&&e.setExtUnpackers(this),this}function E(x,a){var s=this.extUnpackers||(this.extUnpackers=[]);s[x]=i.filter(a)}function d(x){var a=this.extUnpackers||(this.extUnpackers=[]);return a[x]||s;function s(h){return new r(h,x)}}return Nr}var ue;function De(){if(ue)return Dr;ue=1,Dr.DecodeBuffer=t;var r=Lr().preset,e=wr.FlexDecoder;e.mixin(t.prototype);function t(n){if(!(this instanceof t))return new t(n);if(n&&(this.options=n,n.codec)){var i=this.codec=n.codec;i.bufferish&&(this.bufferish=i.bufferish)}}return t.prototype.codec=r,t.prototype.fetch=function(){return this.codec.decode(this)},Dr}var se;function Ne(){if(se)return Tr;se=1,Tr.decode=e;var r=De().DecodeBuffer;function e(t,n){var i=new r(n);return i.write(t),i.read()}return Tr}var Ce={},Me={exports:{}};/**
 * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)
 *
 * @copyright Yusuke Kawasaki
 * @license MIT
 * @constructor
 * @see https://github.com/kawanet/event-lite
 * @see http://kawanet.github.io/event-lite/EventLite.html
 * @example
 * var EventLite = require("event-lite");
 *
 * function MyClass() {...}             // your class
 *
 * EventLite.mixin(MyClass.prototype);  // import event methods
 *
 * var obj = new MyClass();
 * obj.on("foo", function() {...});     // add event listener
 * obj.once("bar", function() {...});   // add one-time event listener
 * obj.emit("foo");                     // dispatch event
 * obj.emit("bar");                     // dispatch another event
 * obj.off("foo");                      // remove event listener
 */(function(r){function e(){if(!(this instanceof e))return new e}(function(t){r.exports=t;var n="listeners",i={on:o,once:E,off:d,emit:x};f(t.prototype),t.mixin=f;function f(s){for(var h in i)s[h]=i[h];return s}function o(s,h){return a(this,s).push(h),this}function E(s,h){var v=this;return y.originalListener=h,a(v,s).push(y),v;function y(){d.call(v,s,y),h.apply(this,arguments)}}function d(s,h){var v=this,y;if(!arguments.length)delete v[n];else if(h){if(y=a(v,s,!0),y){if(y=y.filter(_),!y.length)return d.call(v,s);v[n][s]=y}}else if(y=v[n],y&&(delete y[s],!Object.keys(y).length))return d.call(v);return v;function _(B){return B!==h&&B.originalListener!==h}}function x(s,h){var v=this,y=a(v,s,!0);if(!y)return!1;var _=arguments.length;if(_===1)y.forEach(k);else if(_===2)y.forEach(F);else{var B=Array.prototype.slice.call(arguments,1);y.forEach($)}return!!y.length;function k(g){g.call(v)}function F(g){g.call(v,h)}function $(g){g.apply(v,B)}}function a(s,h,v){if(!(v&&!s[n])){var y=s[n]||(s[n]={});return y[h]||(y[h]=[])}}})(e)})(Me);var $e=Me.exports;Ce.Encoder=rr;var un=$e,qe=ke().EncodeBuffer;function rr(r){if(!(this instanceof rr))return new rr(r);qe.call(this,r)}rr.prototype=new qe;un.mixin(rr.prototype);rr.prototype.encode=function(r){this.write(r),this.emit("data",this.read())};rr.prototype.end=function(r){arguments.length&&this.encode(r),this.flush(),this.emit("end")};var Oe={};Oe.Decoder=Z;var sn=$e,je=De().DecodeBuffer;function Z(r){if(!(this instanceof Z))return new Z(r);je.call(this,r)}Z.prototype=new je;sn.mixin(Z.prototype);Z.prototype.decode=function(r){arguments.length&&this.write(r),this.flush()};Z.prototype.push=function(r){this.emit("data",r)};Z.prototype.end=function(r){this.decode(r),this.emit("end")};var Ye={};Lr();Yr();Ye.createCodec=X.createCodec;var We={};Lr();Yr();We.codec={preset:X.preset};J.encode=Fe().encode;J.decode=Ne().decode;J.Encoder=Ce.Encoder;J.Decoder=Oe.Decoder;J.createCodec=Ye.createCodec;J.codec=We.codec;function cn(){let r=new Map;const{subscribe:e,set:t}=Ge(!1),n=["open","close","error","message","unresponsive"];let i,f,o,E,d=!1;function x(B,k=!1){E=B,d=k,s()}function a(B,k){var F;o.close(),t(!1),clearTimeout(i),clearTimeout(f),(F=r.get(B))==null||F.forEach($=>$(k)),f=setTimeout(s,1e3)}function s(){o=new WebSocket(E),o.binaryType="arraybuffer",o.onopen=B=>{var k;t(!0),clearTimeout(f),(k=r.get("open"))==null||k.forEach(F=>F(B));for(const F of r.keys())n.includes(F)||_("subscribe",F)},o.onmessage=B=>{var D,N,b,l;v();let k=B.data;const F=k instanceof ArrayBuffer;(D=r.get(F?"binary":"message"))==null||D.forEach(w=>w(k));try{k=F?J.decode(new Uint8Array(k)):JSON.parse(k)}catch(w){(N=r.get("error"))==null||N.forEach(u=>u(w));return}(b=r.get("json"))==null||b.forEach(w=>w(k));const{event:$,data:g}=k;$&&((l=r.get($))==null||l.forEach(w=>w(g)))},o.onerror=B=>a("error",B),o.onclose=B=>a("close",B)}function h(B,k){let F=r.get(B);F&&(F.size||_("unsubscribe",B),k?F==null||F.delete(k):r.delete(B))}function v(){clearTimeout(i),i=setTimeout(()=>a("unresponsive"),2e3)}function y(B){!o||o.readyState!==WebSocket.OPEN||(d?o.send(JSON.stringify(B)):o.send(J.encode(B)))}function _(B,k){y({event:B,data:k})}return{subscribe:e,send:y,sendEvent:_,init:x,on:(B,k)=>{let F=r.get(B);return F||(n.includes(B)||_("subscribe",B),F=new Set,r.set(B,F)),F.add(k),()=>{h(B,k)}},off:(B,k)=>{h(B,k)}}}const dn=cn();export{dn as s};
