import{s as q,e as b,n as S,h as O,b as be,k as ye,r as ke,d as Y}from"./utils.js";import{q as ee,H as te,r as se,g as h,u as re,d as l,v as j,i as I,e as de,b as m,s as V,k as Ee,f as _,C as ue,c as T,l as Ce,h as f,w as d,y as Z,m as Be,x as Se,N as fe}from"./scheduler.js";import{g as ne,f as he}from"./index2.js";import{S as X,i as F,a as U,g as Ie,t as $,c as De,b as Ne,d as Ve,m as Te,p as me,e as Oe}from"./index.js";import{d as je,c as _e,X as Pe,f as Ae}from"./ConfirmDialog.js";import{w as Me}from"./singletons.js";let Re={rssi:{rssi:0,ssid:"",disconnected:!0},battery:{soc:100,charging:!1},download_ota:{status:"none",progress:0,error:""}};function ze(){const{subscribe:r,set:e,update:s}=Me(Re);return{subscribe:r,setRSSI:t=>{isNaN(Number(t.rssi))?s(a=>({...a,rssi:{rssi:0,ssid:t.ssid,disconnected:!0}})):s(a=>({...a,rssi:{rssi:Number(t.rssi),ssid:t.ssid,disconnected:!1}}))},setBattery:t=>{s(a=>({...a,battery:{soc:t.soc,charging:t.charging}}))},setDownloadOTA:t=>{s(a=>({...a,download_ota:{status:t.status,progress:t.progress,error:t.error}}))}}}const H=ze();function Ge(r){let e,s,t='<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12a9 9 0 1 0 18 0a9 9 0 1 0-18 0m7-2l4 4m0-4l-4 4"/>',a=[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},r[0]],o={};for(let n=0;n<a.length;n+=1)o=b(o,a[n]);return{c(){e=ee("svg"),s=new te(!0),this.h()},l(n){e=se(n,"svg",{viewBox:!0,width:!0,height:!0});var i=h(e);s=re(i,!0),i.forEach(l),this.h()},h(){s.a=null,j(e,o)},m(n,i){I(n,e,i),s.m(t,e)},p(n,[i]){j(e,o=ne(a,[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},i&1&&n[0]]))},i:S,o:S,d(n){n&&l(e)}}}function He(r,e,s){return r.$$set=t=>{s(0,e=b(b({},e),O(t)))},e=O(e),[e]}class at extends X{constructor(e){super(),F(this,e,He,Ge,q,{})}}function Ue(r){let e,s,t='<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2c2.8-.3 5.5-1.4 5.5-6a4.6 4.6 0 0 0-1.3-3.2a4.2 4.2 0 0 0-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3 0 0 0-6.2 0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2 0 0 0-.1 3.2A4.6 4.6 0 0 0 4 9.5c0 4.6 2.7 5.7 5.5 6c-.6.6-.6 1.2-.5 2V21"/>',a=[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},r[0]],o={};for(let n=0;n<a.length;n+=1)o=b(o,a[n]);return{c(){e=ee("svg"),s=new te(!0),this.h()},l(n){e=se(n,"svg",{viewBox:!0,width:!0,height:!0});var i=h(e);s=re(i,!0),i.forEach(l),this.h()},h(){s.a=null,j(e,o)},m(n,i){I(n,e,i),s.m(t,e)},p(n,[i]){j(e,o=ne(a,[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},i&1&&n[0]]))},i:S,o:S,d(n){n&&l(e)}}}function qe(r,e,s){return r.$$set=t=>{s(0,e=b(b({},e),O(t)))},e=O(e),[e]}class ot extends X{constructor(e){super(),F(this,e,qe,Ue,q,{})}}function Xe(r){let e,s,t='<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 18a3.5 3.5 0 0 0 0-7h-1A5 4.5 0 0 0 7 9a4.6 4.4 0 0 0-2.1 8.4M12 13v9m-3-3l3 3l3-3"/>',a=[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},r[0]],o={};for(let n=0;n<a.length;n+=1)o=b(o,a[n]);return{c(){e=ee("svg"),s=new te(!0),this.h()},l(n){e=se(n,"svg",{viewBox:!0,width:!0,height:!0});var i=h(e);s=re(i,!0),i.forEach(l),this.h()},h(){s.a=null,j(e,o)},m(n,i){I(n,e,i),s.m(t,e)},p(n,[i]){j(e,o=ne(a,[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},i&1&&n[0]]))},i:S,o:S,d(n){n&&l(e)}}}function Fe(r,e,s){return r.$$set=t=>{s(0,e=b(b({},e),O(t)))},e=O(e),[e]}class it extends X{constructor(e){super(),F(this,e,Fe,Xe,q,{})}}function ge(r){let e,s,t,a="Updating Firmware",o,n,i,y,g,D,u,M,W,P,J,k,A,K,v,C,N,ae="Close",E,B,L,oe;function ie(c,x){return c[1].download_ota.status=="progress"?Je:We}let R=ie(r),p=R(r);return C=new Pe({props:{class:"mr-2 h-5 w-5"}}),{c(){e=m("div"),s=m("div"),t=m("h2"),t.textContent=a,o=V(),n=m("div"),i=V(),y=m("div"),g=m("div"),p.c(),D=V(),u=m("p"),M=Ee(r[4]),W=V(),P=m("div"),J=V(),k=m("div"),A=m("div"),K=V(),v=m("button"),Ne(C.$$.fragment),N=m("span"),N.textContent=ae,this.h()},l(c){e=_(c,"DIV",{role:!0,class:!0});var x=h(e);s=_(x,"DIV",{class:!0});var w=h(s);t=_(w,"H2",{class:!0,"data-svelte-h":!0}),ue(t)!=="svelte-1xr5sfu"&&(t.textContent=a),o=T(w),n=_(w,"DIV",{class:!0}),h(n).forEach(l),i=T(w),y=_(w,"DIV",{class:!0});var le=h(y);g=_(le,"DIV",{class:!0});var z=h(g);p.l(z),D=T(z),u=_(z,"P",{class:!0});var ce=h(u);M=Ce(ce,r[4]),ce.forEach(l),z.forEach(l),le.forEach(l),W=T(w),P=_(w,"DIV",{class:!0}),h(P).forEach(l),J=T(w),k=_(w,"DIV",{class:!0});var G=h(k);A=_(G,"DIV",{class:!0}),h(A).forEach(l),K=T(G),v=_(G,"BUTTON",{class:!0});var Q=h(v);Ve(C.$$.fragment,Q),N=_(Q,"SPAN",{"data-svelte-h":!0}),ue(N)!=="svelte-hkb09m"&&(N.textContent=ae),Q.forEach(l),G.forEach(l),w.forEach(l),x.forEach(l),this.h()},h(){f(t,"class","text-base-content text-start text-2xl font-bold"),f(n,"class","divider my-2"),f(u,"class","mt-8 text-2xl"),f(g,"class","bg-base-100 flex flex-col items-center justify-center p-6"),f(y,"class","overflow-y-auto"),f(P,"class","divider my-2"),f(A,"class","flex-grow"),f(v,"class","btn btn-warning text-warning-content inline-flex flex-none items-center"),v.disabled=r[2],f(k,"class","flex flex-wrap justify-end gap-2"),f(s,"class","bg-base-100 shadow-secondary/30 rounded-box pointer-events-auto flex max-h-full min-w-fit max-w-md flex-col justify-between p-4 shadow-lg"),f(e,"role","dialog"),f(e,"class","pointer-events-none fixed inset-0 z-50 flex items-center justify-center")},m(c,x){I(c,e,x),d(e,s),d(s,t),d(s,o),d(s,n),d(s,i),d(s,y),d(y,g),p.m(g,null),d(g,D),d(g,u),d(u,M),d(s,W),d(s,P),d(s,J),d(s,k),d(k,A),d(k,K),d(k,v),Te(C,v,null),d(v,N),B=!0,L||(oe=[Z(v,"click",r[7]),Z(e,"introstart",r[5]),Z(e,"outroend",r[6]),ye(Ae.call(null,e))],L=!0)},p(c,x){R===(R=ie(c))&&p?p.p(c,x):(p.d(1),p=R(c),p&&(p.c(),p.m(g,D))),(!B||x&16)&&Be(M,c[4]),(!B||x&4)&&(v.disabled=c[2])},i(c){B||(U(C.$$.fragment,c),c&&Se(()=>{B&&(E||(E=me(e,he,{y:50},!0)),E.run(1))}),B=!0)},o(c){$(C.$$.fragment,c),c&&(E||(E=me(e,he,{y:50},!1)),E.run(0)),B=!1},d(c){c&&l(e),p.d(),Oe(C),c&&E&&E.end(),L=!1,ke(oe)}}}function We(r){let e;return{c(){e=m("progress"),this.h()},l(s){e=_(s,"PROGRESS",{class:!0}),h(e).forEach(l),this.h()},h(){f(e,"class","progress progress-primary w-56")},m(s,t){I(s,e,t)},p:S,d(s){s&&l(e)}}}function Je(r){let e;return{c(){e=m("progress"),this.h()},l(s){e=_(s,"PROGRESS",{class:!0,max:!0}),h(e).forEach(l),this.h()},h(){f(e,"class","progress progress-primary w-56"),e.value=r[3],f(e,"max","100")},m(s,t){I(s,e,t)},p(s,t){t&8&&(e.value=s[3])},d(s){s&&l(e)}}}function Ke(r){let e,s,t=r[0]&&ge(r);return{c(){t&&t.c(),e=de()},l(a){t&&t.l(a),e=de()},m(a,o){t&&t.m(a,o),I(a,e,o),s=!0},p(a,[o]){a[0]?t?(t.p(a,o),o&1&&U(t,1)):(t=ge(a),t.c(),U(t,1),t.m(e.parentNode,e)):t&&(Ie(),$(t,1,1,()=>{t=null}),De())},i(a){s||(U(t),s=!0)},o(a){$(t),s=!1},d(a){a&&l(e),t&&t.d(a)}}}function Le(r,e,s){let t;be(r,H,u=>s(1,t=u));let{isOpen:a}=e,o=!0,n=0,i="Preparing ...";je(()=>o?!1:(Y(H,t.download_ota.status="idle",t),Y(H,t.download_ota.error="",t),Y(H,t.download_ota.progress=0,t),!0));function y(u){fe.call(this,r,u)}function g(u){fe.call(this,r,u)}const D=()=>{_e(),location.reload()};return r.$$set=u=>{"isOpen"in u&&s(0,a=u.isOpen)},r.$$.update=()=>{r.$$.dirty&2&&t.download_ota.status=="progress"&&s(3,n=t.download_ota.progress),r.$$.dirty&2&&t.download_ota.status=="error"&&s(2,o=!1),r.$$.dirty&2&&(t.download_ota.status=="progress"?s(4,i="Downloading ..."):t.download_ota.status=="error"?s(4,i=t.download_ota.error):t.download_ota.status=="finished"&&(s(4,i="Restarting ..."),s(3,n=0),setTimeout(()=>{_e(),location.reload()},5e3)))},[a,t,o,n,i,y,g,D]}class lt extends X{constructor(e){super(),F(this,e,Le,Ke,q,{isOpen:0})}}const Qe=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,pe=r=>{if(typeof r!="string")throw new TypeError("Invalid argument expected string");const e=r.match(Qe);if(!e)throw new Error(`Invalid argument not valid semver ('${r}' received)`);return e.shift(),e},ve=r=>r==="*"||r==="x"||r==="X",we=r=>{const e=parseInt(r,10);return isNaN(e)?r:e},Ye=(r,e)=>typeof r!=typeof e?[String(r),String(e)]:[r,e],Ze=(r,e)=>{if(ve(r)||ve(e))return 0;const[s,t]=Ye(we(r),we(e));return s>t?1:s<t?-1:0},xe=(r,e)=>{for(let s=0;s<Math.max(r.length,e.length);s++){const t=Ze(r[s]||"0",e[s]||"0");if(t!==0)return t}return 0},ct=(r,e)=>{const s=pe(r),t=pe(e),a=s.pop(),o=t.pop(),n=xe(s,t);return n!==0?n:a&&o?xe(a.split("."),o.split(".")):a||o?a?-1:1:0};export{ot as B,at as C,lt as G,it as a,ct as c,H as t};
